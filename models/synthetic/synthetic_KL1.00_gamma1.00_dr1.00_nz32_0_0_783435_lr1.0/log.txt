Namespace(batch_size=32, cuda=False, dataset='synthetic', dec_dropout_in=0.5, dec_dropout_out=0.5, dec_nh=50, dec_type='lstm', decode_from='', decode_input='', decoding_strategy='greedy', delta_rate=1, device='cpu', enc_nh=50, enc_type='lstm', epochs=50, eval=False, gamma=1.0, iw_nsamples=500, jobid=0, kl_start=1.0, label=True, load_path='', log_path='models/synthetic/synthetic_KL1.00_gamma1.00_dr1.00_nz32_0_0_783435_lr1.0/log.txt', lr=1.0, momentum=0, ni=50, nsamples=1, nz=32, nz_new=32, p_drop=0, reset_dec=False, save_path='models/synthetic/synthetic_KL1.00_gamma1.00_dr1.00_nz32_0_0_783435_lr1.0/model.pt', seed=783435, target_kl=-1, taskid=0, test_data='data/synthetic_data/synthetic_test.txt', test_nepoch=1, train_data='data/synthetic_data/synthetic_train.txt', val_data='data/synthetic_data/synthetic_test.txt', vocab_file='data/synthetic_data/vocab.txt', warm_up=100)
data/synthetic_data/vocab.txt
Train data: 16000 samples
finish reading datasets, vocab size is 1004
dropped sentences: 0
epoch: 0, iter: 0, avg_loss: 91.9838, kl/H(z|x): 15.9542, mi: 0.0727, recon: 76.0295,au 0, time elapsed 3.89s
gamma Parameter containing:
tensor([0.6361, 0.8692, 1.0447, 1.0875, 0.8834, 1.1141, 0.9036, 0.9981, 0.7376,
        1.0701, 1.0894, 0.8052, 1.0607, 0.9636, 0.8960, 1.0999, 1.2594, 1.0827,
        0.9545, 1.0415, 0.8483, 0.7461, 0.9029, 1.0743, 0.9385, 1.0999, 0.7905,
        1.1520, 1.0535, 1.0816, 1.3140, 1.0453], requires_grad=True)
train loc mean tensor([-0.0733, -0.0924, -0.0358, -0.0838, -0.0454,  0.0331, -0.0310,  0.0068,
        -0.0078,  0.0136, -0.0392, -0.0524,  0.0494,  0.0408, -0.0388, -0.0561,
        -0.0274, -0.0274,  0.0320, -0.1015,  0.0355,  0.0182,  0.0461,  0.0107,
         0.0683, -0.0382, -0.0352, -0.0434,  0.0076,  0.0446, -0.0125, -0.0292])
train scale std tensor([7.7909e-05, 7.0655e-05, 8.6690e-05, 3.9981e-05, 5.8483e-05, 5.1343e-05,
        5.1193e-05, 7.1845e-05, 4.4821e-05, 4.0294e-05, 2.5077e-05, 5.2438e-05,
        3.7955e-05, 6.1363e-05, 5.4091e-05, 4.8194e-05, 7.3150e-05, 8.1629e-05,
        4.1456e-05, 6.3313e-05, 8.4339e-05, 2.3192e-05, 9.8620e-05, 2.6473e-05,
        6.0505e-05, 4.4957e-05, 3.8171e-05, 7.3833e-05, 3.8787e-05, 5.0260e-05,
        3.9497e-05, 5.0977e-05])
train scale mean tensor([1.0283, 1.0284, 1.0290, 1.0281, 1.0284, 1.0283, 1.0283, 1.0281, 1.0282,
        1.0285, 1.0286, 1.0284, 1.0279, 1.0284, 1.0276, 1.0282, 1.0295, 1.0288,
        1.0292, 1.0284, 1.0287, 1.0285, 1.0282, 1.0289, 1.0293, 1.0279, 1.0287,
        1.0282, 1.0281, 1.0293, 1.0288, 1.0287])
epoch: 0, iter: 50, avg_loss: 68.9229, kl/H(z|x): 1.8562, mi: -0.0067, recon: 67.0667,au 0, time elapsed 8.64s
epoch: 0, iter: 100, avg_loss: 61.1798, kl/H(z|x): 0.2321, mi: 0.0196, recon: 60.9478,au 0, time elapsed 13.72s
epoch: 0, iter: 150, avg_loss: 60.0701, kl/H(z|x): 0.3995, mi: -0.1306, recon: 59.6706,au 0, time elapsed 19.49s
epoch: 0, iter: 200, avg_loss: 57.2679, kl/H(z|x): 0.1905, mi: -0.0269, recon: 57.0774,au 0, time elapsed 24.24s
epoch: 0, iter: 250, avg_loss: 54.3758, kl/H(z|x): 0.1566, mi: -0.0273, recon: 54.2192,au 0, time elapsed 28.84s
epoch: 0, iter: 300, avg_loss: 52.8017, kl/H(z|x): 0.1288, mi: -0.0506, recon: 52.6729,au 0, time elapsed 33.81s
epoch: 0, iter: 350, avg_loss: 51.9674, kl/H(z|x): 0.1882, mi: 0.0187, recon: 51.7792,au 0, time elapsed 38.53s
epoch: 0, iter: 400, avg_loss: 51.5230, kl/H(z|x): 0.1526, mi: -0.0481, recon: 51.3704,au 0, time elapsed 43.18s
epoch: 0, iter: 450, avg_loss: 51.2951, kl/H(z|x): 0.1565, mi: 0.0256, recon: 51.1385,au 0, time elapsed 47.97s
kl weight 1.0000
VAL --- avg_loss: 48.1727, kl/H(z|x): 0.1342, mi: -0.2018, recon: 48.0385, nll: 48.1727, ppl: 79.7848
0 active units
update best loss
TEST --- avg_loss: 48.2219, kl/H(z|x): 0.1342, mi: -0.0120, recon: 48.0877, nll: 48.2219, ppl: 80.1426
epoch: 1, iter: 500, avg_loss: 47.6891, kl/H(z|x): 0.1346, recon: 47.5546,time elapsed 62.33s
epoch: 1, iter: 550, avg_loss: 50.0957, kl/H(z|x): 0.1378, recon: 49.9579,time elapsed 63.77s
epoch: 1, iter: 600, avg_loss: 50.4986, kl/H(z|x): 0.1395, recon: 50.3591,time elapsed 65.03s
epoch: 1, iter: 650, avg_loss: 49.5509, kl/H(z|x): 0.1456, recon: 49.4053,time elapsed 66.35s
epoch: 1, iter: 700, avg_loss: 49.5276, kl/H(z|x): 0.2423, recon: 49.2853,time elapsed 67.58s
epoch: 1, iter: 750, avg_loss: 49.0258, kl/H(z|x): 0.1555, recon: 48.8703,time elapsed 69.08s
epoch: 1, iter: 800, avg_loss: 48.6905, kl/H(z|x): 0.1673, recon: 48.5232,time elapsed 70.86s
epoch: 1, iter: 850, avg_loss: 48.3193, kl/H(z|x): 0.1522, recon: 48.1671,time elapsed 72.32s
epoch: 1, iter: 900, avg_loss: 48.5319, kl/H(z|x): 0.1697, recon: 48.3622,time elapsed 73.62s
epoch: 1, iter: 950, avg_loss: 47.5075, kl/H(z|x): 0.1012, recon: 47.4063,time elapsed 74.94s
kl weight 1.0000
VAL --- avg_loss: 45.2795, kl/H(z|x): 0.0738, mi: 0.0029, recon: 45.2057, nll: 45.2795, ppl: 61.3332
0 active units
update best loss
TEST --- avg_loss: 45.2758, kl/H(z|x): 0.0738, mi: -0.0522, recon: 45.2020, nll: 45.2758, ppl: 61.3126
epoch: 2, iter: 1000, avg_loss: 45.3208, kl/H(z|x): 0.0742, recon: 45.2465,time elapsed 87.48s
epoch: 2, iter: 1050, avg_loss: 47.0271, kl/H(z|x): 0.0944, recon: 46.9327,time elapsed 89.00s
epoch: 2, iter: 1100, avg_loss: 47.5806, kl/H(z|x): 0.2097, recon: 47.3709,time elapsed 91.38s
epoch: 2, iter: 1150, avg_loss: 47.6823, kl/H(z|x): 0.1700, recon: 47.5123,time elapsed 92.75s
epoch: 2, iter: 1200, avg_loss: 47.0332, kl/H(z|x): 0.1020, recon: 46.9313,time elapsed 93.91s
epoch: 2, iter: 1250, avg_loss: 47.2249, kl/H(z|x): 0.0633, recon: 47.1616,time elapsed 95.02s
epoch: 2, iter: 1300, avg_loss: 46.9512, kl/H(z|x): 0.1286, recon: 46.8226,time elapsed 96.24s
epoch: 2, iter: 1350, avg_loss: 46.9885, kl/H(z|x): 0.1035, recon: 46.8850,time elapsed 97.37s
epoch: 2, iter: 1400, avg_loss: 46.3206, kl/H(z|x): 0.1372, recon: 46.1834,time elapsed 98.49s
epoch: 2, iter: 1450, avg_loss: 47.1521, kl/H(z|x): 0.1887, recon: 46.9634,time elapsed 99.60s
kl weight 1.0000
VAL --- avg_loss: 44.4193, kl/H(z|x): 0.0622, mi: 0.0397, recon: 44.3571, nll: 44.4193, ppl: 56.7194
0 active units
update best loss
TEST --- avg_loss: 44.4166, kl/H(z|x): 0.0622, mi: -0.0181, recon: 44.3544, nll: 44.4166, ppl: 56.7056
epoch: 3, iter: 1500, avg_loss: 45.3653, kl/H(z|x): 0.0619, recon: 45.3034,time elapsed 109.59s
epoch: 3, iter: 1550, avg_loss: 46.6098, kl/H(z|x): 0.0684, recon: 46.5414,time elapsed 110.68s
epoch: 3, iter: 1600, avg_loss: 46.6580, kl/H(z|x): 0.0872, recon: 46.5708,time elapsed 111.78s
epoch: 3, iter: 1650, avg_loss: 46.1828, kl/H(z|x): 0.0844, recon: 46.0984,time elapsed 113.02s
epoch: 3, iter: 1700, avg_loss: 46.3273, kl/H(z|x): 0.0641, recon: 46.2631,time elapsed 114.24s
epoch: 3, iter: 1750, avg_loss: 46.4725, kl/H(z|x): 0.0632, recon: 46.4093,time elapsed 115.38s
epoch: 3, iter: 1800, avg_loss: 46.6433, kl/H(z|x): 0.1000, recon: 46.5433,time elapsed 116.50s
epoch: 3, iter: 1850, avg_loss: 46.1040, kl/H(z|x): 0.0918, recon: 46.0121,time elapsed 117.60s
gamma Parameter containing:
tensor([0.7547, 0.8856, 1.1843, 1.0126, 1.0597, 0.9106, 0.9730, 1.1779, 0.7441,
        1.1986, 0.9274, 0.9449, 1.0565, 0.5328, 0.8193, 1.2728, 1.2570, 0.8743,
        0.9534, 0.7917, 0.8276, 0.8855, 1.0832, 1.0849, 1.1097, 1.1932, 0.7251,
        1.1920, 1.1917, 0.9867, 0.9388, 0.9593], requires_grad=True)
train loc mean tensor([ 0.0197, -0.0169, -0.0196, -0.0653, -0.0198,  0.0277, -0.0709,  0.0039,
         0.0091, -0.0372, -0.0042, -0.0662,  0.0050,  0.0271,  0.0054,  0.0648,
         0.0158, -0.1142,  0.0130, -0.0441, -0.0233,  0.0194,  0.0196, -0.0130,
         0.0155,  0.0078,  0.0079,  0.0202,  0.0312, -0.0052, -0.0383, -0.0199],
       grad_fn=<MeanBackward1>)
train scale std tensor([1.0685e-05, 8.4577e-06, 1.6077e-05, 1.5295e-05, 1.4061e-05, 1.4010e-05,
        2.2436e-05, 1.0087e-05, 5.1636e-06, 7.0330e-06, 5.6599e-06, 6.8874e-06,
        9.7419e-06, 1.8101e-05, 1.2978e-05, 1.5947e-05, 1.4863e-05, 5.4070e-06,
        3.5708e-06, 1.6960e-05, 1.7095e-05, 1.3345e-05, 1.7271e-05, 1.4926e-05,
        8.5931e-06, 1.1095e-05, 5.7805e-06, 1.9978e-05, 1.6887e-05, 5.9923e-06,
        8.9861e-06, 1.3255e-05], grad_fn=<StdBackward1>)
train scale mean tensor([1.0287, 1.0287, 1.0286, 1.0287, 1.0287, 1.0287, 1.0285, 1.0287, 1.0287,
        1.0287, 1.0288, 1.0288, 1.0287, 1.0286, 1.0287, 1.0286, 1.0287, 1.0288,
        1.0289, 1.0287, 1.0286, 1.0287, 1.0286, 1.0286, 1.0289, 1.0288, 1.0288,
        1.0285, 1.0286, 1.0288, 1.0288, 1.0285], grad_fn=<MeanBackward1>)
epoch: 3, iter: 1900, avg_loss: 46.0540, kl/H(z|x): 0.0592, recon: 45.9948,time elapsed 118.72s
epoch: 3, iter: 1950, avg_loss: 45.6893, kl/H(z|x): 0.0609, recon: 45.6284,time elapsed 119.82s
kl weight 1.0000
VAL --- avg_loss: 44.0410, kl/H(z|x): 0.0468, mi: 0.0664, recon: 43.9941, nll: 44.0410, ppl: 54.8018
0 active units
update best loss
gamma Parameter containing:
tensor([0.7531, 0.8573, 1.1776, 1.0084, 1.0749, 0.9298, 0.9545, 1.1919, 0.7384,
        1.2042, 0.9418, 0.9320, 1.0016, 0.5333, 0.8417, 1.2837, 1.2379, 0.8844,
        0.9579, 0.7987, 0.8359, 0.8981, 1.0969, 1.0870, 1.1095, 1.2033, 0.7139,
        1.1977, 1.1889, 0.9906, 0.9035, 0.9766], requires_grad=True)
train loc mean tensor([ 0.0389, -0.0135, -0.0668, -0.0289, -0.0586,  0.0438,  0.0223,  0.0034,
         0.0052,  0.0265,  0.0018,  0.0417, -0.0163,  0.0010,  0.0236, -0.0516,
        -0.0088, -0.0191, -0.0704, -0.0007,  0.0522,  0.0405,  0.0495, -0.0328,
        -0.0161, -0.0143,  0.0084, -0.0512,  0.0116,  0.0380, -0.0292, -0.0483])
train scale std tensor([8.3092e-06, 6.8119e-06, 1.7887e-05, 1.3828e-05, 1.8606e-05, 1.7448e-05,
        2.2577e-05, 3.3867e-06, 6.2293e-06, 4.3768e-06, 6.3535e-06, 7.3117e-06,
        4.1512e-06, 1.5505e-05, 8.7723e-06, 9.0478e-06, 2.0474e-05, 9.4471e-06,
        4.0762e-06, 6.4814e-06, 1.3078e-05, 1.9357e-05, 6.2588e-06, 1.1728e-05,
        7.7367e-06, 9.2317e-06, 7.4100e-06, 1.7443e-05, 1.0280e-05, 2.9517e-06,
        1.0600e-05, 9.2339e-06])
train scale mean tensor([1.0288, 1.0287, 1.0287, 1.0287, 1.0287, 1.0286, 1.0286, 1.0288, 1.0287,
        1.0288, 1.0287, 1.0288, 1.0287, 1.0287, 1.0288, 1.0287, 1.0286, 1.0288,
        1.0289, 1.0288, 1.0287, 1.0287, 1.0288, 1.0287, 1.0288, 1.0288, 1.0288,
        1.0286, 1.0288, 1.0288, 1.0289, 1.0287])
TEST --- avg_loss: 44.0432, kl/H(z|x): 0.0468, mi: -0.0153, recon: 43.9964, nll: 44.0432, ppl: 54.8129
epoch: 4, iter: 2000, avg_loss: 43.9364, kl/H(z|x): 0.0473, recon: 43.8891,time elapsed 129.21s
epoch: 4, iter: 2050, avg_loss: 46.1033, kl/H(z|x): 0.1925, recon: 45.9108,time elapsed 130.29s
epoch: 4, iter: 2100, avg_loss: 46.2411, kl/H(z|x): 0.0922, recon: 46.1489,time elapsed 131.37s
epoch: 4, iter: 2150, avg_loss: 46.2292, kl/H(z|x): 0.0933, recon: 46.1359,time elapsed 132.48s
epoch: 4, iter: 2200, avg_loss: 46.3031, kl/H(z|x): 0.1519, recon: 46.1512,time elapsed 133.61s
epoch: 4, iter: 2250, avg_loss: 46.1080, kl/H(z|x): 0.1128, recon: 45.9952,time elapsed 134.71s
epoch: 4, iter: 2300, avg_loss: 46.2069, kl/H(z|x): 0.1018, recon: 46.1051,time elapsed 135.80s
epoch: 4, iter: 2350, avg_loss: 46.0232, kl/H(z|x): 0.1626, recon: 45.8606,time elapsed 136.88s
epoch: 4, iter: 2400, avg_loss: 46.4018, kl/H(z|x): 0.1171, recon: 46.2848,time elapsed 138.01s
epoch: 4, iter: 2450, avg_loss: 45.8789, kl/H(z|x): 0.0603, recon: 45.8185,time elapsed 139.11s
kl weight 1.0000
VAL --- avg_loss: 43.9069, kl/H(z|x): 0.0898, mi: 0.0050, recon: 43.8171, nll: 43.9069, ppl: 54.1382
0 active units
update best loss
gamma Parameter containing:
tensor([0.7509, 0.8669, 1.1856, 0.9956, 1.0628, 0.9358, 0.9456, 1.1958, 0.7394,
        1.2110, 0.9154, 0.9326, 1.0014, 0.5382, 0.8347, 1.2811, 1.2412, 0.8911,
        0.9606, 0.8028, 0.8493, 0.8925, 1.1058, 1.0843, 1.1013, 1.2081, 0.7034,
        1.2092, 1.1926, 0.9834, 0.9101, 0.9705], requires_grad=True)
train loc mean tensor([-0.0450, -0.0759, -0.0783,  0.0150,  0.1056,  0.1129, -0.0218,  0.0801,
        -0.0061,  0.0265,  0.1380, -0.0496, -0.0869, -0.0271, -0.0230, -0.0508,
         0.0639, -0.0268,  0.0608,  0.0407, -0.0362, -0.0448, -0.0678,  0.0024,
        -0.0354,  0.0236,  0.0404, -0.1080,  0.0892,  0.0413, -0.0047, -0.0542])
train scale std tensor([1.6924e-05, 1.6882e-05, 1.0246e-05, 1.2540e-05, 4.4682e-06, 1.0566e-05,
        1.2307e-05, 1.0101e-05, 1.4016e-05, 2.1958e-05, 2.5869e-05, 1.4119e-05,
        1.4662e-05, 1.0661e-05, 1.0339e-05, 9.7715e-06, 1.3193e-05, 1.2174e-05,
        5.5699e-06, 2.0073e-05, 1.2144e-05, 1.1599e-05, 1.1315e-05, 1.2591e-05,
        2.3388e-05, 1.0639e-05, 1.2606e-05, 1.6476e-05, 1.3287e-05, 1.2702e-05,
        1.0028e-05, 1.5114e-05])
train scale mean tensor([1.0286, 1.0285, 1.0287, 1.0287, 1.0288, 1.0287, 1.0287, 1.0286, 1.0285,
        1.0286, 1.0285, 1.0286, 1.0286, 1.0288, 1.0286, 1.0288, 1.0285, 1.0287,
        1.0289, 1.0286, 1.0287, 1.0288, 1.0287, 1.0287, 1.0284, 1.0286, 1.0288,
        1.0286, 1.0285, 1.0287, 1.0286, 1.0285])
TEST --- avg_loss: 43.9080, kl/H(z|x): 0.0898, mi: 0.0293, recon: 43.8182, nll: 43.9080, ppl: 54.1436
epoch: 5, iter: 2500, avg_loss: 46.1478, kl/H(z|x): 0.0773, recon: 46.0705,time elapsed 148.53s
epoch: 5, iter: 2550, avg_loss: 45.7327, kl/H(z|x): 0.0603, recon: 45.6724,time elapsed 149.88s
epoch: 5, iter: 2600, avg_loss: 45.5843, kl/H(z|x): 0.0852, recon: 45.4991,time elapsed 151.01s
epoch: 5, iter: 2650, avg_loss: 45.9211, kl/H(z|x): 0.0895, recon: 45.8317,time elapsed 152.14s
epoch: 5, iter: 2700, avg_loss: 45.5345, kl/H(z|x): 0.0683, recon: 45.4662,time elapsed 153.30s
